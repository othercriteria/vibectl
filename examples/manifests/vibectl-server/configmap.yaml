apiVersion: v1
kind: ConfigMap
metadata:
  name: vibectl-server-config
  labels:
    app: vibectl-server
data:
  config.yaml: |
    server:
      host: "0.0.0.0"
      port: 50051
      default_model: "anthropic/claude-3-7-sonnet-latest"
      max_workers: 10
      log_level: "INFO"

    # TLS configuration using certificates generated by init container
    tls:
      enabled: true
      cert_file: "/etc/vibectl/certs/server.crt"
      key_file: "/etc/vibectl/certs/server.key"
      ca_bundle_file: "/etc/vibectl/certs/ca-bundle.crt"

    # JWT authentication configuration - at top-level where JWT manager looks for it
    jwt:
      enabled: true
      secret_key: null
      secret_key_file: "/etc/vibectl/secret/jwt-secret"
      algorithm: "HS256"
      issuer: "vibectl-server"
      expiration_days: 30
